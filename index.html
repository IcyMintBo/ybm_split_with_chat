<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="format-detection" content="telephone=no,email=no,address=no">
  <title>YBM Device · Nokia Frame + Entry</title>

  <link rel="stylesheet" href="./styles.css" />
  <link rel="stylesheet" href="./chat/chat.css" />
</head>

<body>
  <div class="desktop">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>

    <div class="stage">

      <!-- ===== View 0: Nokia image launcher1 ===== -->
      <div class="view on" id="viewLauncher" aria-label="Nokia Launcher">
        <div class="phoneWrap">
          <div class="phoneImgWrap" id="launcherPhone">
            <img class="phoneFrame" src="./assets/nokia-frame.png" alt="Nokia frame">

            <div class="screenOverlay">
              <div class="statusRow">
                <span>MNT-ICE NET</span>
                <span class="battery"><span>▮▮▮</span><span class="batBox">79%</span></span>
              </div>

              <div class="logo">边水往事</div>
              <div class="tagline">走山接水 讨生活<br />Get some money · make some money</div>

              <div class="spacer"></div>

              <button class="claimBtn" id="btnClaim">领取手机</button>
              <div class="entryNotice">
                本项目仅供成年人使用 · 所有内容均为虚构角色互动
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ===== View START: Start menu ===== -->
      <div class="view" id="viewStart" aria-label="Start Menu">
        <div class="startPage">
          <header class="startTopbar">
            <div class="startTopbarInner">
              <div class="startTabsTray" role="group" aria-label="顶部功能">
                <nav aria-label="功能面板" class="startTabs">
                  <button class="startTab" data-key="api" type="button">
                    <span class="startDot"></span> API设置
                  </button>

                  <button class="startTab" data-key="help" type="button">
                    <span class="startDot p"></span> 操作说明
                  </button>

                  <button class="startTab" data-key="log" type="button">
                    <span class="startDot o"></span> 更新日志
                  </button>

                  <button class="startTab" data-key="skin" type="button">
                    <span class="startDot s"></span> 皮肤
                  </button>
                </nav>
              </div>
            </div>
          </header>

          <main class="startStage">
            <section class="startCenter">
              <div aria-label="开始剧情" class="startFloating" role="region">
                <div class="startChrome">
                  <div aria-hidden="true" class="startLights">
                    <span class="startLight"></span><span class="startLight y"></span><span class="startLight g"></span>
                  </div>
                  <div class="startChromeTitle"> MNT-ICE NET </div>
                </div>
                <div class="startCore">
                  <div class="startHero">
                    <div class="startHeroTop">
                      <div>
                        <h1 class="startTitle">边水往事</h1>
                        <p class="startSubtitle">走山接水讨生活<br />Get some money · make some money</p>
                      </div>
                      <div class="startBadge">● MNT-ICE NET · 79%</div>
                    </div>

                    <div class="startPhoneWrap">
                      <div class="startDash" aria-label="配置区">
                        <div class="dashGrid">
                          <button class="dashBox big" id="btnWorldbook" type="button">世界书</button>
                          <button class="dashBox big" id="btnPresetList" type="button">预设</button>

                          <div class="dashRight">
                            <button class="dashBox small" id="btnRole" type="button">人设</button>
                            <button class="dashBox small" id="btnChatlog" type="button">聊天记录</button>
                            <button class="dashBox small" id="btnPresetQuick" type="button">正则</button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="startBottomActions" aria-label="行动区">
                      <div class="dashActions">
                        <button class="btn secondary" id="btnSaveCfg" type="button">保存设置</button>
                        <button class="btn" id="btnResetCfg" type="button">恢复默认</button>
                      </div>
                      <button class="btn primary dashGo" id="btnGo" type="button">出发</button>
                    </div>

                    <div class="startCta"></div>
                  </div>
                </div>
              </div>
            </section>

            <aside class="startSide" id="startSide" data-show="false" aria-label="Start Side Panel"></aside>
          </main>

          <div aria-hidden="true" class="startOverlay" data-open="false" id="startOverlay">
            <div class="startPanel" id="overlayPanel">
              <div class="startChrome">
                <div aria-hidden="true" class="startLights">
                  <span class="startLight"></span><span class="startLight y"></span><span class="startLight g"></span>
                </div>
                <div class="startChromeTitle" id="startOverlayTitle">PANEL</div>
                <button class="startOverlayClose" id="startOverlayCloseBtn" type="button">关闭</button>
              </div>
              <div class="startPanelBody" id="startOverlayBody"></div>
            </div>
          </div>

          <template id="startTplApi">
            <div class="startKvs apiPanel" id="apiPanel">
              <div class="startKv">
                <div class="startK">API 提供方</div>
                <select id="apiProvider">
                  <option value="openai">OpenAI / 兼容接口</option>
                  <option value="proxy">自建代理</option>
                  <option value="local" disabled>本地模型（占位）</option>
                </select>
              </div>

              <div class="startKv">
                <div class="startK">Base URL</div>
                <input id="apiBaseUrl" placeholder="例如：https://api.xxx.com/v1" autocomplete="off" />
                <div class="apiHintRow">
                  <span class="apiHint">会自动补全/修正到 <b>/v1</b></span>
                </div>
              </div>

              <div class="startKv">
                <div class="startK">API Key</div>

                <div class="apiKeyRow">
                  <input id="apiKey" type="password" placeholder="sk-..." autocomplete="off" />
                  <button id="apiKeyToggle" class="btn secondary apiKeyToggle" type="button" aria-label="显示/隐藏 Key"
                    title="显示/隐藏">
                    👁
                  </button>
                </div>
              </div>

              <!-- 连接后才会填充模型列表 -->
              <div class="startKv">
                <div class="startK">模型</div>
                <div class="apiModelRow">
                  <select id="apiModelSelect" class="apiModelSelect">
                    <option value="">（请先连接）</option>
                  </select>
                </div>
              </div>


              <div class="apiBtnRow">
                <button class="btn secondary" id="btnApiConnect" type="button">连接</button>
                <button class="btn" id="btnApiTest" type="button" disabled>测试</button>
                <button class="btn primary" id="btnApiSave" type="button" disabled>保存</button>
              </div>

              <div class="apiStatus" id="apiStatus" aria-live="polite">未连接</div>

              <div class="startItem apiTip">
                <b>操作顺序：</b>填 BaseURL + Key → 点<b>连接</b> → 选择模型 → 点<b>测试</b> → <b>保存</b>。
              </div>
            </div>
          </template>


<template id="startTplHelp">
  <div class="startList">
    <div class="startItem"><b>遇到问题</b><br />遇见点不动、显示异常等情况，直接刷新网页即可。</div>

    <div class="startItem"><b>1）填写 API</b><br />填写 API 地址和 Key。</div>
    <div class="startItem"><b>2）拉取模型</b><br />拉取模型后点击测试，确认可用。</div>
    <div class="startItem"><b>3）世界书</b><br />选择 世界书 → 载入默认。</div>
    <div class="startItem"><b>4）预设</b><br />选择 预设 → 载入默认（可按喜好调整；每个条目都可点击查看/编辑）。</div>
    <div class="startItem"><b>5）人设</b><br />设置自己的人设，点击出发。</div>
    <div class="startItem"><b>6）进入手机</b><br />进入 Chat 界面后点击右上角小手机。</div>
    <div class="startItem"><b>7）短信入口</b><br />点击第一个信封。右上角三横线按钮 → 载入默认。</div>
    <div class="startItem"><b>完成</b><br />所有设置完成，可以开始游玩啦。</div>

    <div class="startItem"><b>重要说明</b><br />出于合规考虑，预设里 NSFW 不提供更进阶的提示词设计示例；如有需要，用户可根据自身理解自行摸索与调整。</div>
  </div>
</template>


          <template id="startTplLog">
            <div class="startList">
              <div class="startItem"><b>v0.1</b> · 起始页框架完成<br />三段式结构 + 手机覆盖面板。</div>
              <div class="startItem"><b>v0.2</b> · UI 立体化<br />窗口顶栏 + 粗边框 + 浮层阴影。</div>
              <div class="startItem"><b>下一步</b><br />把按钮、面板内容接到真实逻辑（配置保存/读取、跳转到剧情页）。</div>
            </div>
          </template>

          <template id="startTplSkin">
            <div class="startList">
              <div class="startItem"><b>经典黄</b><br />当前背景风格（默认）。</div>
              <div class="startItem"><b>夜色</b><br />深色背景 + 更强对比（占位）。</div>
              <div class="startItem"><b>薄荷</b><br />更冷的配色（占位）。</div>
              <button class="btn primary" type="button">应用（占位）</button>
              <div class="startItem" style="opacity:.85">
                <b>提示：</b>点不动，还没做。
              </div>
            </div>
          </template>
        </div>
      </div>
      <template id="startTplWorldbook">
        <div class="wbRowBtns">
          <button class="wbBtn wbBtnPrimary" id="wb-load-default" type="button">载入默认</button>
          <button class="wbBtn" id="wb-import-file" type="button">导入文件</button>
          <button class="wbBtn wbBtnPrimary" id="wb-export-file" type="button">导出下载</button>
        </div>
        <input id="wb-file" type="file" accept="application/json" style="display:none;">

        <div class="wbPad">
          <div class="wbHeaderRow">
            <div>
              <div class="wbTitleBig">世界书</div>
              <div class="wbSub">全局 + 联系人两套，按开关决定是否注入。</div>
            </div>
          </div>

          <div class="wbSection">
            <div class="wbSectionHead">
              <div class="wbSectionTitle">全局世界书 <span class="wbSectionSub">（总是注入）</span></div>
              <button class="wbBtn wbBtnPrimary" id="wb-add-global" type="button">＋ 新增</button>
            </div>
            <div id="wb-global-list" class="wbList"></div>
          </div>

          <div class="wbSection">
            <div class="wbSectionHead">
              <div class="wbSectionTitle">
                联系人世界书
                <span class="wbSectionSub wbSectionSubContact">（显示：—）</span>
                <select id="wb-contact-picker" class="wbContactPicker" aria-label="选择联系人"></select>
              </div>

              <button class="wbBtn wbBtnPrimary" id="wb-add-contact" type="button">＋ 新增</button>
            </div>
            <div id="wb-contact-list" class="wbList"></div>
          </div>

          <div class="wbSection">
            <div class="wbSectionHead">
              <div class="wbSectionTitle">导入 / 导出</div>
              <div class="wbRowBtns">
                <button class="wbBtn" id="wb-export" type="button">导出</button>
                <button class="wbBtn wbBtnPrimary" id="wb-import" type="button">导入</button>
              </div>
            </div>
            <textarea id="wb-io" class="wbTextarea" placeholder="这里放 JSON（导入 / 导出用）"></textarea>
          </div>
        </div>
      </template>

      <template id="startTplPresets">
        <div class="wbRowBtns">
          <button class="wbBtn wbBtnPrimary" id="preset-load-default" type="button">载入默认</button>
          <button class="wbBtn" id="preset-import-file" type="button">导入文件</button>
          <button class="wbBtn wbBtnPrimary" id="preset-export-file" type="button">导出下载</button>
        </div>
        <input id="preset-file" type="file" accept="application/json" style="display:none;">

        <div class="wbPad">
          <div class="wbHeaderRow">
            <div>
              <div class="wbTitleBig">预设</div>
              <div class="wbSub">按开关注入 system prompt（影响剧情写作风格）。</div>
            </div>
          </div>

          <div class="wbSection">
            <div class="wbSectionHead">
              <div class="wbSectionTitle">全局预设</div>
              <button class="wbBtn wbBtnPrimary" id="preset-add-global" type="button">＋ 新增</button>
            </div>
            <div id="preset-global-list" class="wbList"></div>
          </div>

          <div class="wbSection">
            <div class="wbSectionHead">
              <div class="wbSectionTitle">导入 / 导出</div>
              <div class="wbRowBtns">
                <button class="wbBtn" id="preset-export" type="button">导出</button>
                <button class="wbBtn wbBtnPrimary" id="preset-import" type="button">导入</button>
              </div>
            </div>
            <textarea id="preset-io" class="wbTextarea" placeholder="这里放 JSON（导入 / 导出用）"></textarea>
          </div>
        </div>
      </template>

      <!-- ===== View 1: Main window ===== -->
      <div class="view" id="viewMain" aria-label="Main Entry">
        <div class="window" id="window">
          <div class="titlebar">
            <div class="dots" aria-hidden="true">
              <span class="dot r"></span><span class="dot y"></span><span class="dot g"></span>
            </div>
            <div class="tb-title" id="tbTitle">THE TAVERN · ENTRY</div>
            <div class="tb-actions">
              <div class="pill" data-goto="0">入口</div>
              <div class="pill" data-goto="1">API</div>
              <div class="pill" data-goto="2">说明</div>
              <div class="pill primary" data-action="start">出发</div>
            </div>
          </div>

          <div class="pages" id="pages">
            <!-- Page 1 -->
            <section class="page" aria-label="入口">
              <div class="label">DEVICE STATUS: <b style="color:var(--rust)">ONLINE</b></div>
              <div class="h1">THE TAVERN</div>
              <p class="sub">领取成功。这里是系统入口：干净、直接、能用。</p>
              <div class="sep"></div>

              <div class="card">
                <div class="iconBox rust">
                  <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2">
                    <path d="M7 7h10v10H7z" />
                    <path d="M9 12h6" />
                  </svg>
                </div>
                <div>
                  <div style="font-weight:900; letter-spacing:.06em;">进入剧情</div>
                  <div class="sub">默认配置足够用。想折腾，再去右边两页。</div>
                </div>
              </div>

              <div class="card soft">
                <div class="iconBox sky">
                  <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2">
                    <path d="M4 12h16" />
                    <path d="M12 4v16" />
                  </svg>
                </div>
                <div>
                  <div style="font-weight:900; letter-spacing:.06em;">小提示</div>
                  <div class="sub">手机端左右滑动切页；电脑端主要看中间主窗。</div>
                </div>
              </div>

              <div class="btnRow">
                <button class="btn" data-goto="1">API →</button>
                <button class="btn primary" data-action="start">出发</button>
              </div>

              <div class="pageDots" aria-hidden="true">
                <span class="on"></span><span></span><span></span>
              </div>
            </section>

            <!-- Page 2 -->
            <section class="page" aria-label="API">
              <div class="label">CONNECTIVITY: <b style="color:var(--rust)">READY</b></div>
              <div class="h1">API</div>
              <p class="sub">像旧机器背后的接口面板：插对、拧紧、亮灯。</p>
              <div class="sep"></div>

              <div class="card">
                <div class="iconBox">
                  <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2">
                    <path d="M7 7h10v10H7z" />
                    <path d="M4 12h3M17 12h3M12 4v3M12 17v3" />
                  </svg>
                </div>
                <div>
                  <div style="font-weight:900; letter-spacing:.06em;">接口地址</div>
                  <div class="sub">https://…（占位）</div>
                </div>
              </div>

              <div class="card soft">
                <div class="iconBox rust">
                  <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2">
                    <path d="M12 3v18" />
                    <path d="M7 8h10" />
                    <path d="M7 16h10" />
                  </svg>
                </div>
                <div>
                  <div style="font-weight:900; letter-spacing:.06em;">状态码说明位</div>
                  <div class="sub">401/403/503 的弹窗、测试按钮、保存配置——都塞在这里。</div>
                </div>
              </div>

              <div class="btnRow">
                <button class="btn" data-goto="0">← 返回</button>
                <button class="btn primary" data-goto="2">说明 →</button>
              </div>

              <div class="pageDots" aria-hidden="true">
                <span></span><span class="on"></span><span></span>
              </div>
            </section>

            <!-- Page 3 -->
            <section class="page" aria-label="操作说明">
              <div class="label">MANUAL: <b style="color:var(--rust)">OK</b></div>
              <div class="h1">MANUAL</div>
              <p class="sub">短、清楚、有台阶。像旧系统的说明卡。</p>
              <div class="sep"></div>

              <div class="card">
                <div class="iconBox">
                  <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2">
                    <rect x="5" y="4" width="14" height="16" rx="2" />
                    <path d="M8 8h8M8 12h8M8 16h5" />
                  </svg>
                </div>
                <div class="sub">
                  · 手机端左右滑动切页<br />
                  · “出发”进入对话栏<br />
                  · 需要更换世界书/预设时，回到这里配置
                </div>
              </div>

              <div class="card soft">
                <div class="iconBox rust">
                  <svg viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2">
                    <path d="M4 7h16v10H4z" />
                    <path d="M8 10h8M8 14h5" />
                  </svg>
                </div>
                <div>
                  <div style="font-weight:900; letter-spacing:.06em;">功能位（以后）</div>
                  <div class="sub">更新日志 / 撤回偷看 / 存档导入导出——写成“旧系统通知”。</div>
                </div>
              </div>

              <div class="btnRow">
                <button class="btn" data-goto="1">← 返回</button>
                <button class="btn primary" data-action="start">出发</button>
              </div>

              <div class="pageDots" aria-hidden="true">
                <span></span><span></span><span class="on"></span>
              </div>
            </section>
          </div>
        </div>
      </div>
      <div id="mountChat"></div>



    </div>
  </div>

  <script src="./phone/phoneEngine.js"></script>
  <script src="./app.js"></script>
  <script src="./chat/chat.js"></script>
</body>

</html>